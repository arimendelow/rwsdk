---
title: React Server Components
description: React, Server Components, Server Actions, and Suspense
---

import { Aside, Tabs, TabItem, LinkCard } from "@astrojs/starlight/components";

React is used to build your user interface. By default, all components are server components. That means that the component is rendered on the server as HTML and then streamed to the client. These do not include any client-side interactivity.

```tsx
export default function MyServerComponent() {
  return <div>Hello, from the server!</div>;
}
```

When a user needs to interact with your component: clicking a button, setting state, etc, then you must use a client component. Mark the client component with the `"use client"` directive. This will be hydrated by React in the browser.

```tsx mark={1}
"use client";

export default function MyClientComponent() {
  return <button>Click me</button>;
}
```

## Fetching and displaying data

React Server Components run on the server, they can easily fetch data and make it part of the payload that's sent to the client.

```tsx title="src/app/pages/todos/TodoPage.tsx" "async"
import { requestContext } from "@redwoodjs/sdk/worker";

export async function Todos() {
  const { data } = requestContext;
  const todos = await db.todo.findMany({ where: { userId: data.user.id } });
  return (
    <ol>
      {todos.map((todo) => (
        <li key={todo.id}>{todo.title}</li>
      ))}
    </ol>
  );
}

export async function TodoPage() {
  return (
    <div>
      <h1>Todos</h1>
      <Suspense fallback={<div>Loading...</div>}>
        <Todos />
      </Suspense>
    </div>
  );
}

---
The `TodoPage` component is a server component. Since it's rendered by a route, it has access to `requestContext`. The `Todos` component is also a server component and can directly access `requestContext` to fetch data.
---
```

<Aside type="tip" title="Suspense">
  When a server component is async, you'll able to wrap it in a `Suspense`
  boundary. This will allow you to show a loading state while the data is being
  fetched.
</Aside>{" "}

## Server Functions

Allow you to execute code on the server from a client component.

```tsx title="@/pages/todos/functions.tsx" mark={1}
"use server";

import { requestContext } from "@redwoodjs/sdk/worker";

export async function addTodo(formData: FormData) {
  const { data } = requestContext;
  const title = formData.get("title");
  await db.todo.create({ data: { title, userId: data.user.id } });
}

---
The `addTodo` function is a server function. It is executed on the server when the form is submitted from a client side component. The form data is sent to the server and the function is executed. The result is sent back to the client, parsed by React, and the view is updated with the new todo.
---
```

```tsx title="@/pages/todos/AddTodo.tsx" mark={1, 3}
"use client";

import { addTodo } from "./functions";

export default function AddTodo() {
  return (
    <form action={addTodo}>
      <input type="text" name="title" />
      <button type="submit">Add</button>
    </form>
  );
}
```

### Request Context

The `requestContext` object is available to all server components and server functions. It provides access to the current request, environment variables, and shared data that was populated by middleware.

```tsx
import { requestContext } from "@redwoodjs/sdk/worker";

// Access request context in any server component or function
const { request, params, env, data, cf } = requestContext;
```

For more information about `requestContext`, see the [Request Context](/core/routing#request-context) section.
